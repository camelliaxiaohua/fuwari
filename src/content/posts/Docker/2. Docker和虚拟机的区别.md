---
title: 2. Docker和虚拟机的区别
category: docker
tags:
  - docker教程
published: 2024-11-21
updated: 2024-11-21
draft: false
---
---
## 1. 虚拟机的原理

**虚拟机**（virtual machine）是在操作系统中**模拟**硬件设备，然后运行另一个操作系统，比如在 Windows 系统里面运行 Ubuntu 系统，这样就可以运行任意的Ubuntu应用了。

**实现原理：** **虚拟机是在现有操作系统**上通过虚拟化软件（如 VMware、VirtualBox）创建的一种模拟独立计算环境的技术。虚拟化软件（Hypervisor）负责将物理硬件资源抽象为虚拟资源，允许多个虚拟机共享这些资源。虚拟机运行的操作系统和应用程序认为自己是在真实硬件上运行，而实际上所有硬件操作都被虚拟化层拦截、转换并映射到宿主机的实际资源上。虚拟机实现了资源隔离，使每个虚拟机的操作互不干扰。

**命令执行过程包括：** 用户在虚拟机中输入命令后，虚拟机的操作系统解析命令，如果涉及特权操作（如硬件访问），**虚拟化软件会拦截并将其转换为宿主机的实际硬件操作。**命令执行完成后，结果返回给虚拟机操作系统，最终反馈给用户。

**性能：虚拟机的性能通常低于物理机**，这是因为虚拟化层引入了额外的开销。在虚拟机中，所有的硬件访问请求都需要通过虚拟化层进行转换和处理，尤其是涉及特权指令时，这种转译会导致性能下降。此外，虚拟机共享宿主机的硬件资源，多个虚拟机同时运行时，CPU、内存、存储等资源的竞争会进一步影响性能，尤其在资源密集型的任务中表现更加明显。虚拟机的磁盘和网络IO操作也往往比直接在物理机上执行要慢，因为虚拟磁盘的性能依赖于宿主机的存储系统，如果宿主机性能不高，虚拟机的IO性能也会受到限制。内存管理方面，虚拟化层需要为每个虚拟机动态分配物理内存，当宿主机内存不足时，虚拟机的性能可能显著下降，甚至导致崩溃。尽管现代虚拟化技术提供了硬件加速支持，减少了一部分开销，但与物理机相比，虚拟机的性能仍存在一定差距，特别是在需要高性能计算或密集IO的应用中。

## 2. Docker和虚拟机的区别

首先，**Docker 是基于容器的虚拟化技术**，而虚拟机是基于硬件的虚拟化技术。**Docker 容器共享宿主机的操作系统内核**，容器之间相互隔离，但它们没有虚拟化出独立的操作系统，使用的是相同的宿主机操作系统内核。相反，**虚拟机通过虚拟化层（Hypervisor）模拟出完整的硬件环境，每个虚拟机都有独立的操作系统，包括独立的内核**，因此资源开销较大。

其次，**Docker 的性能更高**，因为它直接在宿主机的操作系统之上运行，没有虚拟化硬件的开销，而虚拟机在运行时需要通过虚拟化层来管理硬件资源，存在额外的性能损耗。Docker 容器启动非常快，因为不需要启动完整的操作系统，而虚拟机通常需要几秒甚至更长时间来启动，因为它们需要加载独立的操作系统。

最后，**隔离机制不同**。Docker 容器的隔离是基于操作系统级别的，尽管容器之间隔离良好，但仍然共享同一个内核，存在潜在的安全风险。而虚拟机则通过完全独立的操作系统实现隔离，安全性和隔离性更强，适合高安全需求的场景。

> [!tip] Tip
> **Docker**仅仅是封装函数库，并没有模拟完整的操作系统。

<img src="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/markdown/bf22bf02-6faa-4a76-aa46-724524ce3ad1.png" style="zoom: 33%;" />

| **特性**   | **Docker** | **虚拟机** |
| -------- | ---------- | ------- |
| **性能**   | 接近原生       | 性能较差    |
| **硬盘占用** | 一般为MB      | 一般为GB   |
| **启动**   | 秒级         | 分钟级     |
