---
title: 索引和映射
category: 分布式搜索
tags:
  - 分布式搜索
  - Elasticsearch
published: 2024-09-17
updated: 2024-09-17
draft: false
---
---

在 **Elasticsearch**（简称 ES）中，**索引（Index）** 和 **映射（Mapping）** 是两个重要概念，它们决定了数据的组织方式和搜索性能。

### 1. 索引（Index）

在 Elasticsearch 中，**索引** 类似于关系型数据库中的 **数据库（Database）** 或 **表（Table）**，用于存储和管理一组**结构相似**的文档。

<img src="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/markdown/1736934887266-6b16c39b-056b-4381-9dea-b737f7e775f2.png" alt="" style="width: 800px;">

> 1. 一个索引包含**多个文档**，每个文档都有**唯一的ID**。
> 2. 每个索引都有自己的**倒排索引结构**，允许 Elasticsearch 进行高效搜索。
> 3. Elasticsearch 不是把所有数据存到一个地方，而是**把数据拆分成多个小块（分片，Shard）**，然后分布存储在不同的服务器上。这样既能提高存储容量，也能提高查询速度，并支持分布式扩展。

### 2. 映射（Mapping）

**映射（Mapping）** 定义了索引中 **字段（Field）** 的类型和属性，相当于**数据库中的表结构**。

> 1. Elasticsearch 是 **无模式（Schema-Free）** 的，可以**自动推断**数据类型，但也可以**手动定义**数据结构。
> 2. 通过 **Mapping**，可以控制字段类型、索引方式、分词规则等。

**手动创建Mapping：**

```json
PUT blog
{
  "mappings": {
    "properties": {
      "title": {
        "type": "text",
        "analyzer": "ik_max_word"  // 中文分词
      },
      "content": {
        "type": "text",
        "analyzer": "ik_smart"
      },
      "publish_date": {
        "type": "date"
      },
      "views": {
        "type": "integer"
      }
    }
  }
}
```

+ `title` **和** `content`：定义为 `text` 类型，使用中文分词器 `ik_max_word` 和 `ik_smart`。
+ `publish_date`：定义为 `date` 类型，存储发布时间。
+ `views`：定义为 `integer` 类型，存储浏览量。

### 3. MySQL与Elasticsearch

| **MySQL** | **Elasticsearch** | **说明**                                                    |
| :-------: | :---------------: | --------------------------------------------------------- |
|   Table   |       Index       | 索引(index)，就是文档的集合，类似数据库的表(table)。                         |
|    Row    |     Document      | 文档（Document），就是一条条的数据，类似数据库中的行（Row），文档都是JSON格式。           |
|  Column   |       Field       | 字段（Field），就是JSON文档中的字段，类似数据库中的列（Column）。                  |
|  Schema   |      Mapping      | Mapping（映射）是索引中文档的约束，例如字段类型约束。类似数据库的表结构（Schema）。          |
|    SQL    |        DSL        | DSL是elasticsearch提供的JSON风格的请求语句，用来操作elasticsearch，实现CRUD。 |

<img src="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/markdown/1736949271666-14eaaa41-5575-4e60-8c04-40498ec1a326.png" alt="" style="width: 800px;">
