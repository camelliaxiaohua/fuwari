---
title: 安装Elasticsearch
category: 分布式搜索
tags:
  - 分布式搜索
  - Elasticsearch
published: 2024-09-18
updated: 2024-09-18
draft: false
---
---

### 1. 单点部署Elasticsearch

#### 1.1. 安装elasticsearch

+ **拉取镜像**

```d
docker pull elasticsearch:7.17.27
```

> [!quote] 
> **MacOS 可用的版本为** `ocker.elastic.co/elasticsearch/elasticsearch:7.16.2`

+ **创建网络**

```d
docker network create --driver bridge \
  --subnet=192.168.100.0/24 \
  my_custom_network
```

> [!quote] 
> **Bridge 网络模式**：每个容器有一个独立的 IP 地址，通常会在容器生命周期内保持不变，除非容器被删除并重新创建。

+ **启动Elasticsearch**

```d
docker run -d --restart=unless-stopped \
  --network my_custom_network \
  --ip 192.168.100.10 \
  -p 9200:9200 -p 9300:9300 \
  --name elasticsearch \
  -e "discovery.type=single-node" \
  -e "ES_JAVA_OPTS=-Xms1g -Xmx1g" \
  elasticsearch:7.17.27
```

> [!quote]
> 如果在创建容器时不指定 IP 地址，则 IP 地址将由 Docker 自动分配，且每次重启容器时，IP 地址可能会发生变化。

最后访问 `http://localhost:9200/`，出现这个内容即表明安装成功。

```json
{
  "name": "d806a1b9d24c",
  "cluster_name": "docker-cluster",
  "cluster_uuid": "uyyxUgq3TCWN6SMMqLEhfA",
  "version": {
    "number": "7.16.2",
    "build_flavor": "default",
    "build_type": "docker",
    "build_hash": "2b937c44140b6559905130a8650c64dbd0879cfb",
    "build_date": "2021-12-18T19:42:46.604893745Z",
    "build_snapshot": false,
    "lucene_version": "8.10.1",
    "minimum_wire_compatibility_version": "6.8.0",
    "minimum_index_compatibility_version": "6.0.0-beta1"
  },
  "tagline": "You Know, for Search"
}
```

#### 1.2. 安装分词器

+ **安装 [IK](https://release.infinilabs.com/analysis-ik/stable/) 分词器**

将分词器插件移到 elasticsearch 中

```d
docker cp /Users/camellia/Downloads/elasticsearch-analysis-ik-7.16.2.zip elasticsearch:/tmp
```

解压插件安装

```d
cd /usr/share/elasticsearch/plugins
mkdir analysis-ik
unzip /tmp/elasticsearch-analysis-ik-7.16.2.zip -d analysis-ik
```

重新启动 Elasticsearch

```bat
exit  # 退出容器
docker restart elasticsearch
```

验证分词器是否安装成功

```json
curl -X GET "localhost:9200/_cat/plugins?v"
```

<img src="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/markdown/1737081144389-6252b8d1-ba2a-43d0-b1dd-1ef0bf13d66c.png" style="zoom:80%;" />

#### 1.3. 安装kibana

Kibana 是一个强大的前端工具，用于可视化和交互式分析存储在 Elasticsearch 中的数据，广泛应用于日志分析、监控、安全和业务智能等领域。

```d
docker run --name kibana \
  -e ELASTICSEARCH_HOSTS=http://elasticsearch:9200 \
  -v /Volumes/camellia/DockerVolumes/kibana:/usr/share/kibana/data \
  -p 5601:5601 \
  --network elasticsearch \
  -d kibana:7.16.2
```
