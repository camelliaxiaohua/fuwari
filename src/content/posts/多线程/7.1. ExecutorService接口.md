---
title: 1. å¤šçº¿ç¨‹åŸºç¡€3
category: å¹¶å‘
tags:
  - å¤šçº¿ç¨‹
published: 2022-08-10
updated: 2022-08-10
draft: true
---

Javaæ ‡å‡†åº“æä¾›äº†`ExecutorService`æ¥å£è¡¨ç¤ºçº¿ç¨‹æ± ï¼Œå®ƒçš„å…¸å‹ç”¨æ³•å¦‚ä¸‹ï¼š

```java
// åˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ± 
ExecutorService executor = Executors.newFixedThreadPool(3);
// æäº¤ä»»åŠ¡
executor.submit(task1);
executor.submit(task2);
executor.submit(task3);
executor.submit(task4);
executor.submit(task5);
```

å› ä¸º`ExecutorService`åªæ˜¯æ¥å£ï¼ŒJavaæ ‡å‡†åº“æä¾›çš„å‡ ä¸ªå¸¸ç”¨å®ç°ç±»æœ‰ï¼š

:::danger
+ `**<font style="color:rgb(143,149,158);background-color:rgb(251,191,188);">FixedThreadPool</font>**`ï¼šçº¿ç¨‹æ•°å›ºå®šçš„çº¿ç¨‹æ± ï¼›
+ `**<font style="color:rgb(143,149,158);background-color:rgb(251,191,188);">CachedThreadPool</font>**`ï¼šçº¿ç¨‹æ•°æ ¹æ®ä»»åŠ¡åŠ¨æ€è°ƒæ•´çš„çº¿ç¨‹æ± ï¼›
+ `**<font style="color:rgb(143,149,158);background-color:rgb(251,191,188);">SingleThreadExecutor</font>**`ï¼šä»…å•çº¿ç¨‹æ‰§è¡Œçš„çº¿ç¨‹æ± ã€‚

:::

åˆ›å»ºè¿™äº›çº¿ç¨‹æ± çš„æ–¹æ³•éƒ½è¢«å°è£…åˆ°`Executors`è¿™ä¸ªç±»ä¸­ã€‚

## `FixedThreadPool`(<font style="background-color:#FBF5CB;">å›ºå®š</font>çš„çº¿ç¨‹æ± )
```java
// thread-pool
import java.util.concurrent.*;

public class Main {
    public static void main(String[] args) {
        // åˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± 
        ExecutorService es = Executors.newFixedThreadPool(4);
        for (int i = 0; i < 6; i++) {
            es.submit(new Task("" + i));
        }
        // å…³é—­çº¿ç¨‹æ± :
        es.shutdown();
    }
}

class Task implements Runnable {
    private final String name;

    public Task(String name) {
        this.name = name;
    }

    @Overridepublic void run() {
        System.out.println("start task " + name);
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
        }
        System.out.println("end task " + name);
    }
}
```

è§‚å¯Ÿæ‰§è¡Œç»“æœï¼Œæˆ‘ä»¬ä¸€æ¬¡æ€§æäº¤6ä¸ªä»»åŠ¡ã€‚ç”±äºçº¿ç¨‹æ± ä»…æœ‰4ä¸ªçº¿ç¨‹ï¼Œæœ€åˆçš„4ä¸ªä»»åŠ¡å°†ä¼šå¹¶è¡Œæ‰§è¡Œã€‚åªæœ‰å½“çº¿ç¨‹å˜ä¸ºç©ºé—²çŠ¶æ€æ—¶ï¼Œåç»­çš„ä¸¤ä¸ªä»»åŠ¡æ‰ä¼šæ‰§è¡Œã€‚

:::danger
**ç¨‹åºç»“æŸæ—¶ï¼Œåº”å…³é—­çº¿ç¨‹æ± ã€‚**`**shutdown()**`**æ–¹æ³•èƒ½å¤Ÿåœ¨æ‰€æœ‰å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åå…³é—­çº¿ç¨‹æ± ã€‚è€Œ**`**shutdownNow()**`**æ–¹æ³•å°†ç«‹åˆ»åœæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œ**`**awaitTermination()**`**æ–¹æ³•ä¼šåœ¨æŒ‡å®šæ—¶é—´å†…ç­‰å¾…ä»¥ä¾¿å®Œæˆçº¿ç¨‹æ± çš„å…³é—­ã€‚**

:::

## `CachedThreadPool`(<font style="background-color:#FBF5CB;">åŠ¨æ€</font>è°ƒæ•´çš„çº¿ç¨‹æ± ï¼‰
å¦‚æœæˆ‘ä»¬æŠŠçº¿ç¨‹æ± æ”¹ä¸º`**CachedThreadPool**`ï¼Œç”±äºè¿™ä¸ªçº¿ç¨‹æ± çš„å®ç°ä¼šæ ¹æ®ä»»åŠ¡æ•°é‡åŠ¨æ€è°ƒæ•´çº¿ç¨‹æ± çš„å¤§å°ï¼Œæ‰€ä»¥6ä¸ªä»»åŠ¡å¯ä¸€æ¬¡æ€§å…¨éƒ¨åŒæ—¶æ‰§è¡Œã€‚

```java
import java.util.concurrent.*;

public class CachedThreadPool {
    public static void main(String[] args) {
        ExecutorService es = Executors.newCachedThreadPool();
        for (int i = 0; i < 6; i++) {
            es.submit(new CachedThreadTask(""+i));
        }
        es.shutdown();
    }
}

class CachedThreadTask implements Runnable {  
    private String name;  

    public CachedThreadTask(String name) {  
        this.name = name;  
    }

    @Override   
    public void run() {    
        System.out.println(name+" is running");    
        try {    
            Thread.sleep(300);    
        } catch (InterruptedException e) {     
            e.printStackTrace();    
        }
        System.out.println(name+" is stopped");    
    }
}
```

## ğŸŒ• `<font style="color:#DF2A3F;">ThreadPoolExecutor</font>`
`<font style="color:rgb(64, 64, 64);">ThreadPoolExecutor</font>`<font style="color:rgb(64, 64, 64);"> æ˜¯ Java ä¸­ç”¨äºç®¡ç†çº¿ç¨‹æ± çš„æ ¸å¿ƒç±»ï¼Œå®ƒæä¾›äº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶æ¥ç®¡ç†çº¿ç¨‹æ± çš„è¡Œä¸ºã€‚ç›¸æ¯”äº </font>`<font style="color:rgb(64, 64, 64);">Executors</font>`<font style="color:rgb(64, 64, 64);"> å·¥å‚ç±»æä¾›çš„ç®€å•çº¿ç¨‹æ± ï¼ˆå¦‚ </font>`<font style="color:rgb(64, 64, 64);">newFixedThreadPool</font>`<font style="color:rgb(64, 64, 64);">ã€</font>`<font style="color:rgb(64, 64, 64);">newCachedThreadPool</font>`<font style="color:rgb(64, 64, 64);"> ç­‰ï¼‰ï¼Œ</font>`<font style="color:rgb(64, 64, 64);">ThreadPoolExecutor</font>`<font style="color:rgb(64, 64, 64);"> å…è®¸ä½ è‡ªå®šä¹‰çº¿ç¨‹æ± çš„æ ¸å¿ƒå‚æ•°ï¼Œä¾‹å¦‚æ ¸å¿ƒçº¿ç¨‹æ•°ã€æœ€å¤§çº¿ç¨‹æ•°ã€çº¿ç¨‹ç©ºé—²æ—¶é—´ã€ä»»åŠ¡é˜Ÿåˆ—ç­‰ã€‚</font>

![](https://cdn.nlark.com/yuque/0/2025/png/43007687/1738742241906-7203c4fa-0df1-48b5-be2d-85fb0a36e9d3.png)

### `ThreadPoolExecutor`æ ¸å¿ƒå‚æ•°
```java
public ThreadPoolExecutor( 
    int corePoolSize,          // æ ¸å¿ƒçº¿ç¨‹æ•°
    int maximumPoolSize,       // æœ€å¤§çº¿ç¨‹æ•°
    long keepAliveTime,        // çº¿ç¨‹ç©ºé—²æ—¶é—´
    TimeUnit unit,             // ç©ºé—²æ—¶é—´å•ä½
    BlockingQueue<Runnable> workQueue, // ä»»åŠ¡é˜Ÿåˆ—
    ThreadFactory threadFactory,       // çº¿ç¨‹å·¥å‚
    RejectedExecutionHandler handler   // æ‹’ç»ç­–ç•¥
)
```

+ `**<font style="color:rgb(64, 64, 64);">corePoolSize</font>**`<font style="color:rgb(64, 64, 64);">ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå³çº¿ç¨‹æ± ä¸­å§‹ç»ˆä¿æŒå­˜æ´»çš„çº¿ç¨‹æ•°é‡ï¼Œå³ä½¿å®ƒä»¬å¤„äºç©ºé—²çŠ¶æ€ã€‚</font>
+ `**<font style="color:rgb(64, 64, 64);">maximumPoolSize</font>**`<font style="color:rgb(64, 64, 64);">ï¼šçº¿ç¨‹æ± ä¸­å…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°ã€‚å½“ä»»åŠ¡é˜Ÿåˆ—æ»¡äº†ä¸”å½“å‰çº¿ç¨‹æ•°å°äºæœ€å¤§çº¿ç¨‹æ•°æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºæ–°çº¿ç¨‹ã€‚</font>
+ `**<font style="color:rgb(64, 64, 64);">keepAliveTime</font>**`<font style="color:rgb(64, 64, 64);">ï¼šå½“çº¿ç¨‹æ•°è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹åœ¨ç»ˆæ­¢å‰ç­‰å¾…æ–°ä»»åŠ¡çš„æœ€é•¿æ—¶é—´ã€‚</font>
+ `**<font style="color:rgb(64, 64, 64);">unit</font>**`<font style="color:rgb(64, 64, 64);">ï¼š</font>`<font style="color:rgb(64, 64, 64);">keepAliveTime</font>`<font style="color:rgb(64, 64, 64);"> çš„æ—¶é—´å•ä½ï¼Œä¾‹å¦‚ </font>`<font style="color:rgb(64, 64, 64);">TimeUnit.SECONDS</font>`<font style="color:rgb(64, 64, 64);">ã€</font>`<font style="color:rgb(64, 64, 64);">TimeUnit.MILLISECONDS</font>`<font style="color:rgb(64, 64, 64);"> ç­‰ã€‚</font>
+ `**<font style="color:rgb(64, 64, 64);">workQueue</font>**`<font style="color:rgb(64, 64, 64);">ï¼šç”¨äºä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ã€‚</font>

> <font style="color:rgb(64, 64, 64);">å¸¸ç”¨çš„é˜Ÿåˆ—æœ‰ï¼š</font>
>
> `**<font style="color:rgb(64, 64, 64);">LinkedBlockingQueue</font>**`<font style="color:rgb(64, 64, 64);">ï¼šæ— ç•Œé˜Ÿåˆ—ï¼ˆé™¤éæŒ‡å®šå®¹é‡ï¼‰ã€‚</font>
>
> `**<font style="color:rgb(64, 64, 64);">ArrayBlockingQueue</font>**`<font style="color:rgb(64, 64, 64);">ï¼šæœ‰ç•Œé˜Ÿåˆ—ã€‚</font>
>
> `**<font style="color:rgb(64, 64, 64);">SynchronousQueue</font>**`<font style="color:rgb(64, 64, 64);">ï¼šä¸å­˜å‚¨ä»»åŠ¡çš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰å¾…ä¸€ä¸ªç§»é™¤æ“ä½œã€‚</font>
>

+ `**<font style="color:rgb(64, 64, 64);">threadFactory</font>**`<font style="color:rgb(64, 64, 64);">ï¼šç”¨äºåˆ›å»ºæ–°çº¿ç¨‹çš„å·¥å‚ï¼Œå¯ä»¥è‡ªå®šä¹‰çº¿ç¨‹çš„åç§°ã€ä¼˜å…ˆçº§ç­‰ã€‚</font>

> `**<font style="color:rgb(64, 64, 64);">Executors.defaultThreadFactory()</font>**`ï¼š`<font style="color:rgb(64, 64, 64);">Executors</font>`<font style="color:rgb(64, 64, 64);"> å·¥å…·ç±»æä¾›çš„é»˜è®¤çº¿ç¨‹å·¥å‚ã€‚å®ƒä¼šåˆ›å»ºæ™®é€šçš„éå®ˆæŠ¤çº¿ç¨‹ï¼Œçº¿ç¨‹åç§°ä¸º </font>`<font style="color:rgb(64, 64, 64);">pool-N-thread-M</font>`<font style="color:rgb(64, 64, 64);"> çš„æ ¼å¼ï¼ˆ</font>`<font style="color:rgb(64, 64, 64);">N</font>`<font style="color:rgb(64, 64, 64);"> æ˜¯çº¿ç¨‹æ± ç¼–å·ï¼Œ</font>`<font style="color:rgb(64, 64, 64);">M</font>`<font style="color:rgb(64, 64, 64);"> æ˜¯çº¿ç¨‹ç¼–å·ï¼‰ã€‚</font>
>
> `**<font style="color:rgb(64, 64, 64);">Executors.privilegedThreadFactory()</font>**`**<font style="color:rgb(64, 64, 64);">ï¼š</font>**<font style="color:rgb(64, 64, 64);">è¿™æ˜¯ä¸€ä¸ªç‰¹æƒçº¿ç¨‹å·¥å‚ï¼Œåˆ›å»ºçš„çº¿ç¨‹ä¼šç»§æ‰¿å½“å‰çº¿ç¨‹çš„è®¿é—®æ§åˆ¶ä¸Šä¸‹æ–‡ï¼ˆ</font>`<font style="color:rgb(64, 64, 64);">AccessControlContext</font>`<font style="color:rgb(64, 64, 64);">ï¼‰å’Œç±»åŠ è½½å™¨ã€‚é€‚ç”¨äºéœ€è¦ç‰¹æ®Šæƒé™çš„åœºæ™¯ã€‚</font>
>
> **<font style="color:rgb(64, 64, 64);">è‡ªå®šä¹‰ </font>**`**<font style="color:rgb(64, 64, 64);">ThreadFactory</font>**`**<font style="color:rgb(64, 64, 64);"> å®ç°ï¼š</font>**<font style="color:rgb(64, 64, 64);">é€šè¿‡å®ç° </font>`<font style="color:rgb(64, 64, 64);">ThreadFactory</font>`<font style="color:rgb(64, 64, 64);"> æ¥å£æ¥å®Œå…¨æ§åˆ¶çº¿ç¨‹çš„åˆ›å»ºè¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œè®¾ç½®çº¿ç¨‹åç§°ã€ä¼˜å…ˆçº§ã€æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ç­‰ã€‚</font>
>

+ `**<font style="color:rgb(64, 64, 64);">handler</font>**`**<font style="color:rgb(64, 64, 64);">ï¼š</font>**<font style="color:rgb(64, 64, 64);">å½“ä»»åŠ¡é˜Ÿåˆ—å·²æ»¡ä¸”çº¿ç¨‹æ•°è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°æ—¶ï¼Œç”¨äºå¤„ç†æ–°ä»»åŠ¡çš„æ‹’ç»ç­–ç•¥ã€‚</font>

> <font style="color:rgb(64, 64, 64);">å¸¸è§çš„æ‹’ç»ç­–ç•¥æœ‰ï¼š</font>
>
> `<font style="color:rgb(64, 64, 64);">ThreadPoolExecutor.AbortPolicy</font>`<font style="color:rgb(64, 64, 64);">ï¼šé»˜è®¤ç­–ç•¥ï¼Œç›´æ¥æŠ›å‡º </font>`<font style="color:rgb(64, 64, 64);">RejectedExecutionException</font>`<font style="color:rgb(64, 64, 64);">ã€‚</font>
>
> `<font style="color:rgb(64, 64, 64);">ThreadPoolExecutor.CallerRunsPolicy</font>`<font style="color:rgb(64, 64, 64);">ï¼šç”±æäº¤ä»»åŠ¡çš„çº¿ç¨‹ç›´æ¥æ‰§è¡Œä»»åŠ¡ã€‚</font>
>
> `<font style="color:rgb(64, 64, 64);">ThreadPoolExecutor.DiscardPolicy</font>`<font style="color:rgb(64, 64, 64);">ï¼šç›´æ¥ä¸¢å¼ƒä»»åŠ¡ï¼Œä¸æŠ›å‡ºå¼‚å¸¸ã€‚</font>
>
> `<font style="color:rgb(64, 64, 64);">ThreadPoolExecutor.DiscardOldestPolicy</font>`<font style="color:rgb(64, 64, 64);">ï¼šä¸¢å¼ƒé˜Ÿåˆ—ä¸­æœ€æ—§çš„ä»»åŠ¡ï¼Œç„¶åé‡æ–°å°è¯•æäº¤å½“å‰ä»»åŠ¡ã€‚</font>
>

```java
import java.util.concurrent.*;

public class ThreadPoolExecutorExample {
    public static void main(String[] args) {
        // åˆ›å»ºçº¿ç¨‹æ± 
        ThreadPoolExecutor executor = new ThreadPoolExecutor(
            2, // æ ¸å¿ƒçº¿ç¨‹æ•°
            4, // æœ€å¤§çº¿ç¨‹æ•°
            60, // çº¿ç¨‹ç©ºé—²æ—¶é—´
            TimeUnit.SECONDS, // æ—¶é—´å•ä½
            new LinkedBlockingQueue<>(10), // ä»»åŠ¡é˜Ÿåˆ—
            Executors.defaultThreadFactory(), // çº¿ç¨‹å·¥å‚
            new ThreadPoolExecutor.AbortPolicy() // æ‹’ç»ç­–ç•¥
        );
        // æäº¤ä»»åŠ¡
        for (int i = 0; i < 15; i++) {
            final int taskId = i;
            executor.execute(() -> {
                System.out.println("Task " + taskId + " is running on thread " + Thread.currentThread().getName());
                try {
                    Thread.sleep(1000); // æ¨¡æ‹Ÿä»»åŠ¡æ‰§è¡Œ
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            });
        }
        // å…³é—­çº¿ç¨‹æ± 
        executor.shutdown();
    }
}
```

> <font style="color:rgb(64, 64, 64);">æ ¹æ®ã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹ï¼Œå»ºè®®ä¸è¦ç›´æ¥ä½¿ç”¨Executorsæ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œè€Œæ˜¯é€šè¿‡ThreadPoolExecutorçš„æ–¹å¼æ‰‹åŠ¨åˆ›å»ºã€‚å› ä¸ºExecutorsè¿”å›çš„çº¿ç¨‹æ± å¯èƒ½æœ‰èµ„æºè€—å°½çš„é£é™©ï¼Œæ¯”å¦‚FixedThreadPoolå’ŒCachedThreadPoolå…è®¸çš„è¯·æ±‚é˜Ÿåˆ—é•¿åº¦å’Œçº¿ç¨‹æ•°é‡å¯èƒ½ä¼šå¯¼è‡´OOMã€‚</font>
>

## `ScheduledThreadPool`
`<font style="color:rgb(64, 64, 64);">ScheduledThreadPool</font>`<font style="color:rgb(64, 64, 64);"> æ˜¯ Java ä¸­ç”¨äºæ‰§è¡Œå®šæ—¶ä»»åŠ¡å’Œå‘¨æœŸæ€§ä»»åŠ¡çš„çº¿ç¨‹æ± ã€‚å®ƒæ˜¯é€šè¿‡ </font>`<font style="color:rgb(64, 64, 64);">ScheduledThreadPoolExecutor</font>`<font style="color:rgb(64, 64, 64);"> ç±»å®ç°çš„ï¼Œç»§æ‰¿è‡ª </font>`<font style="color:rgb(64, 64, 64);">ThreadPoolExecutor</font>`<font style="color:rgb(64, 64, 64);">ï¼Œå¹¶å®ç°äº† </font>`<font style="color:rgb(64, 64, 64);">ScheduledExecutorService</font>`<font style="color:rgb(64, 64, 64);"> æ¥å£ã€‚</font>`<font style="color:rgb(64, 64, 64);">ScheduledThreadPool</font>`<font style="color:rgb(64, 64, 64);"> å¯ä»¥ç”¨äºæ‰§è¡Œä»¥ä¸‹ç±»å‹çš„ä»»åŠ¡ï¼š</font>

1. **<font style="color:rgb(64, 64, 64);">å»¶è¿Ÿä»»åŠ¡</font>**<font style="color:rgb(64, 64, 64);">ï¼šåœ¨æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´åæ‰§è¡Œä»»åŠ¡ã€‚</font>
2. **<font style="color:rgb(64, 64, 64);">å‘¨æœŸæ€§ä»»åŠ¡</font>**<font style="color:rgb(64, 64, 64);">ï¼šä»¥å›ºå®šçš„é—´éš”æ—¶é—´é‡å¤æ‰§è¡Œä»»åŠ¡ï¼Œæˆ–è€…ä»¥å›ºå®šçš„å»¶è¿Ÿæ—¶é—´é‡å¤æ‰§è¡Œä»»åŠ¡ã€‚</font>

åˆ›å»ºä¸€ä¸ª`ScheduledThreadPool`ä»ç„¶æ˜¯é€šè¿‡`Executors`ç±»ã€‚

```java
ScheduledExecutorService es = new ScheduledThreadPoolExecutor(5);
```

![](https://cdn.nlark.com/yuque/0/2025/png/43007687/1738749024232-f49b2b08-c5be-4aca-8319-df8f4d7e1d0b.png)

### `schedule`
æˆ‘ä»¬å¯ä»¥æäº¤ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œå®ƒä¼šåœ¨æŒ‡å®šå»¶è¿Ÿååªæ‰§è¡Œä¸€æ¬¡ï¼š

```java
// 1ç§’åæ‰§è¡Œä¸€æ¬¡æ€§ä»»åŠ¡
es.schedule(new Task("å»¶è¿Ÿä»»åŠ¡"), 3, TimeUnit.SECONDS);
```

### `scheduleAtFixedRate`
å¦‚æœä»»åŠ¡ä»¥å›ºå®šçš„æ¯3ç§’æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š

```java
// 1ç§’åå¼€å§‹æ‰§è¡Œå®šæ—¶ä»»åŠ¡ï¼Œæ¯3ç§’æ‰§è¡Œã€‚
es.scheduleAtFixedRate(new Task("å›ºå®šé¢‘ç‡ä»»åŠ¡"), 1, 3, TimeUnit.SECONDS);
```

### `scheduleWithFixedDelay`
å¦‚æœä»»åŠ¡ä»¥å›ºå®šçš„3ç§’ä¸ºé—´éš”æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š

```java
// 1ç§’åå¼€å§‹æ‰§è¡Œå®šæ—¶ä»»åŠ¡ï¼Œä»¥3ç§’ä¸ºé—´éš”æ‰§è¡Œã€‚
es.scheduleWithFixedDelay(new Task("å›ºå®šå»¶è¿Ÿä»»åŠ¡"), 1, 3, TimeUnit.SECONDS);
```

å®Œæ•´ä»£ç ï¼š

```java
import java.util.concurrent.Executors;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.ScheduledThreadPoolExecutor;
import java.util.concurrent.TimeUnit;

public class ScheduledThreadPoolExample {
    public static void main(String[] args) {
        ScheduledExecutorService es = new ScheduledThreadPoolExecutor(5);
        try {
            es.schedule(new Task("å»¶è¿Ÿä»»åŠ¡"), 3, TimeUnit.SECONDS);
            es.scheduleAtFixedRate(new Task("å›ºå®šé¢‘ç‡ä»»åŠ¡"), 1, 3, TimeUnit.SECONDS);
            es.scheduleWithFixedDelay(new Task("å›ºå®šå»¶è¿Ÿä»»åŠ¡"), 1, 3, TimeUnit.SECONDS);
            Thread.sleep(10000);
            es.shutdown();
        }catch (InterruptedException e){
            e.printStackTrace();
            es.shutdownNow();
        }finally {
            es.shutdownNow();
        }
    }
}

class Task implements Runnable {
    private String name;

    Task(String name){
        this.name = name;
    }
    public void run() {
        Thread.currentThread().setName(name);
        System.out.println(Thread.currentThread().getName() + " task is running");
    }
}
```

### `**FixedRate**`**å’Œ**`**FixedDelay**`**çš„åŒºåˆ«ã€‚**
`FixedRate`æ˜¯æŒ‡ä»»åŠ¡æ€»æ˜¯ä»¥å›ºå®šæ—¶é—´é—´éš”è§¦å‘ï¼Œ**ä¸ç®¡ä»»åŠ¡æ‰§è¡Œå¤šé•¿æ—¶é—´**ã€‚

```plain
â”‚â–‘â–‘â–‘â–‘   â”‚â–‘â–‘â–‘â–‘â–‘â–‘ â”‚â–‘â–‘â–‘    â”‚â–‘â–‘â–‘â–‘â–‘  â”‚â–‘â–‘â–‘  
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â–¶
â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚
```

è€Œ`FixedDelay`æ˜¯æŒ‡ï¼Œ**ä¸Šä¸€æ¬¡ä»»åŠ¡æ‰§è¡Œå®Œæ¯•å**ï¼Œç­‰å¾…å›ºå®šçš„æ—¶é—´é—´éš”ï¼Œå†æ‰§è¡Œä¸‹ä¸€æ¬¡ä»»åŠ¡ã€‚

```plain
â”‚â–‘â–‘â–‘â”‚       â”‚â–‘â–‘â–‘â–‘â–‘â”‚       â”‚â–‘â–‘â”‚       â”‚â–‘
â””â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â–¶
    â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚     â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚  â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚
```

å› æ­¤ï¼Œä½¿ç”¨`ScheduledThreadPool`æ—¶ï¼Œæˆ‘ä»¬è¦æ ¹æ®éœ€è¦é€‰æ‹©æ‰§è¡Œä¸€æ¬¡ã€`FixedRateæ‰§è¡Œ`è¿˜æ˜¯`FixedDelayæ‰§è¡Œ`ã€‚

ç»†å¿ƒçš„ç«¥é‹è¿˜å¯ä»¥æ€è€ƒä¸‹é¢çš„é—®é¢˜ï¼š

+ åœ¨FixedRateæ¨¡å¼ä¸‹ï¼Œå‡è®¾æ¯ç§’è§¦å‘ï¼Œå¦‚æœæŸæ¬¡ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡1ç§’ï¼Œåç»­ä»»åŠ¡ä¼šä¸ä¼šå¹¶å‘æ‰§è¡Œï¼Ÿ
    - **æ˜¯å¦ä¼šå¹¶å‘æ‰§è¡Œ**ï¼šæ˜¯çš„ï¼Œ`ScheduledThreadPoolExecutor` æ˜¯æ”¯æŒå¹¶å‘æ‰§è¡Œçš„ã€‚å‡å¦‚ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´è¶…è¿‡äº†è®¾å®šçš„å›ºå®šé¢‘ç‡é—´éš”ï¼ˆä¾‹å¦‚ä»»åŠ¡æ‰§è¡Œæ—¶é—´ä¸º 2 ç§’ï¼Œä½†è®¾å®šçš„æ˜¯æ¯ç§’è§¦å‘ä¸€æ¬¡ï¼‰ï¼Œ`ScheduledThreadPoolExecutor` ä¼šå°è¯•å¹¶è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œç¡®ä¿è§¦å‘é¢‘ç‡ä¸å—å½±å“ã€‚è¿™ä¼šå¯¼è‡´å¤šä¸ªä»»åŠ¡å¹¶å‘æ‰§è¡Œã€‚
+ å¦‚æœä»»åŠ¡æŠ›å‡ºäº†å¼‚å¸¸ï¼Œåç»­ä»»åŠ¡æ˜¯å¦ç»§ç»­æ‰§è¡Œï¼Ÿ
    - **å¼‚å¸¸å¤„ç†**ï¼šå¦‚æœä»»åŠ¡æŠ›å‡ºäº†å¼‚å¸¸ä¸”æœªæ•è·ï¼Œ`ScheduledThreadPoolExecutor` ä¼šå–æ¶ˆè¯¥ä»»åŠ¡çš„åç»­æ‰§è¡Œï¼Œå¯¼è‡´è¯¥ä»»åŠ¡ä¸å†è¢«è°ƒåº¦ã€‚å¦‚æœå¸Œæœ›å³ä½¿ä»»åŠ¡æŠ›å‡ºå¼‚å¸¸åä¹Ÿèƒ½ç»§ç»­æ‰§è¡Œï¼Œå¯ä»¥åœ¨ä»»åŠ¡ä¸­æ•è·å¼‚å¸¸ï¼Œé¿å…æŠ›å‡ºåˆ° `ScheduledThreadPoolExecutor`ã€‚

Javaæ ‡å‡†åº“è¿˜æä¾›äº†ä¸€ä¸ª`java.util.Timer`ç±»ï¼Œè¿™ä¸ªç±»ä¹Ÿå¯ä»¥å®šæœŸæ‰§è¡Œä»»åŠ¡ï¼Œä½†æ˜¯ï¼Œä¸€ä¸ª`Timer`ä¼šå¯¹åº”ä¸€ä¸ª`Thread`ï¼Œæ‰€ä»¥ï¼Œä¸€ä¸ª`Timer`åªèƒ½å®šæœŸæ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œå¤šä¸ªå®šæ—¶ä»»åŠ¡å¿…é¡»å¯åŠ¨å¤šä¸ª`Timer`ï¼Œè€Œä¸€ä¸ª`ScheduledThreadPool`å°±å¯ä»¥è°ƒåº¦å¤šä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨`ScheduledThreadPool`å–ä»£æ—§çš„`Timer`ã€‚



